"use strict";var _baseComponent=_interopRequireDefault(require("../helpers/baseComponent")),_eventsMixin=_interopRequireDefault(require("../helpers/mixins/eventsMixin")),_useNativeAPI=require("../helpers/hooks/useNativeAPI"),common=_interopRequireWildcard(require("../helpers/wxs/common")),_props=require("./props");function _getRequireWildcardCache(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(_getRequireWildcardCache=function(e){return e?n:t})(e))}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};t=_getRequireWildcardCache(t);if(t&&t.has(e))return t.get(e);var n,i,r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n]);return r.default=e,t&&t.set(e,r),r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}var fieldNames={lable:"title",value:"value"},getOptions=function(e){return common.getOptions(e,fieldNames)};(0,_baseComponent.default)({useField:!0,behaviors:[(0,_eventsMixin.default)()],relations:{"../field/index":{type:"ancestor"},"../radio/index":{type:"descendant",observer:function(){this.callDebounceFn(this.changeValue)}}},properties:_props.props,data:{fieldNames:fieldNames,inputValue:"",keys:[]},observers:_defineProperty({value:function(e){this.hasFieldDecorator||(this.updated(e),this.changeValue({value:e}))},inputValue:function(e){this.hasFieldDecorator&&this.changeValue({value:e})}},"options, disabled, readOnly, hasLine, withListComponent, iconPosition, iconSize, iconOn, iconOff, prefixCls",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0],r=t[1],o=t[2],a=t[3],u=t[4],l=t[5],c=t[6],s=t[7],p=t[8],f=t[9];this.changeValue({value:this.data.inputValue,options:i,disabled:r,readOnly:o,hasLine:a,withListComponent:u,iconPosition:l,iconSize:c,iconOn:s,iconOff:p,prefixCls:f})}),methods:{updated:function(e){this.data.inputValue!==e&&this.setData({inputValue:e})},changeValue:function(){var a=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=_objectSpread(_objectSpread({},this.data),{},{value:this.data.inputValue},e),u=e.value,t=e.options,l=e.disabled,c=e.readOnly,s=e.hasLine,p=e.withListComponent,f=e.iconPosition,d=e.iconSize,h=e.iconOn,y=e.iconOff,n=e.prefixCls,i=getOptions(t);(0,_useNativeAPI.nextTick)(function(){var r,o,e=0<i.length?a.querySelectorAll(".".concat(n,"__radio")):a.getRelationsByName("../radio/index");o=[],(e=e)&&0<e.length&&(r=e.length-1,e.forEach(function(e,t){var n=u===e.data.value,i=""===h&&""===y;e.changeValue(n,t,t===r,{disabled:l,readOnly:c,hasLine:s,hasFieldDecorator:!!a.hasFieldDecorator,withListComponent:p,iconPosition:f,iconSize:!p&&""===d?"23":d,iconOn:!p&&i?"success":h,iconOff:p?y||h:i?"circle":y}),o.push(e.data)})),a.data.keys!==o&&a.setData({keys:o})})},onChange:function(e){this.triggerEvent("change",_objectSpread(_objectSpread(_objectSpread({},e),this.getValue(e.value)),{},{name:this.data.name,value:e.value}))},onRadioChange:function(e){var t=e.currentTarget.dataset.index;this.onChange(_objectSpread(_objectSpread({},e.detail),{},{index:t}))},getValue:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data.inputValue,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.data.keys,n=e?[e]:[],i=t.filter(function(e){return n.includes(e.value)}).map(function(e){return e.title})||[],r=t.map(function(e){return e.value}),o=n.map(function(e){return r.indexOf(e)});return{value:e,displayValue:null!=i[0]?i[0]:"",selectedIndex:null!=o[0]?o[0]:-1,selectedValue:e,cols:t}},getBoundingClientRect:function(e){return this.cellGroup=this.cellGroup||this.querySelector("#wux-cell-group"),this.cellGroup&&this.cellGroup.getBoundingClientRect(e)}}});