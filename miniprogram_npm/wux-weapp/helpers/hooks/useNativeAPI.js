"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.chooseMedia=chooseMedia,exports.getMenuButtonBoundingClientRectSync=getMenuButtonBoundingClientRectSync,exports.getSystemInfoSync=getSystemInfoSync,exports.nextTick=nextTick,exports.uploadFile=uploadFile,exports.vibrateShort=vibrateShort;var _global=require("../internals/global"),_excluded=["count","mediaType","sourceType","maxDuration","sizeType","camera","compressed"],_excluded2=["url","filePath","name","header","formData","timeout","enableProfile","enableHttp2"];function ownKeys(t,e){var o,i=Object.keys(t);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(t),e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,o)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(o),!0).forEach(function(e){_defineProperty(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function _defineProperty(e,t,o){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);o=o.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}function _objectWithoutProperties(e,t){if(null==e)return{};var o,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),n=0;n<r.length;n++)o=r[n],0<=t.indexOf(o)||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o]);return i}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};for(var o,i={},r=Object.keys(e),n=0;n<r.length;n++)o=r[n],0<=t.indexOf(o)||(i[o]=e[o]);return i}var fakeMediaResult=function(e,t){var o;return"type"in t?t:e.mediaType.includes("video")?{tempFiles:[{tempFilePath:t.tempFilePath,size:t.size,duration:t.duration,height:t.height,width:t.width,thumbTempFilePath:t.tempFilePath,fileType:"video"}],type:"video"}:(e=t.tempFilePaths,t=t.tempFiles,o=void 0===t?[]:t,{tempFiles:(void 0===e?[]:e).map(function(e,t){return{tempFilePath:o[t].path||e,size:o[t].size,fileType:"image"}}),type:"image"})};function chooseMedia(t){function e(e){s.success&&s.success(fakeMediaResult(t,e))}var o=t.count,o=void 0===o?9:o,i=t.mediaType,i=void 0===i?["image","video"]:i,r=t.sourceType,r=void 0===r?["album","camera"]:r,n=t.maxDuration,n=void 0===n?10:n,a=t.sizeType,a=void 0===a?["original","compressed"]:a,u=t.camera,u=void 0===u?"back":u,c=t.compressed,c=void 0===c||c,s=_objectWithoutProperties(t,_excluded);return"function"==typeof _global.miniprogramThis.chooseMedia?_global.miniprogramThis.chooseMedia(_objectSpread(_objectSpread({},t),{},{success:e})):i.includes("video")?(i=_objectSpread(_objectSpread({sourceType:r,compressed:c,maxDuration:void 0===t.maxDuration?60:n,camera:u},s),{},{success:e}),_global.miniprogramThis.chooseVideo(i)):(c=_objectSpread(_objectSpread({count:o,sizeType:a,sourceType:r},s),{},{success:e}),_global.miniprogramThis.chooseImage(c))}function uploadFile(e){var t=e.url,o=e.filePath,i=e.name,i=void 0===i?"file":i,r=e.header,r=void 0===r?{}:r,n=e.formData,n=void 0===n?{}:n,a=e.timeout,a=void 0===a?20:a,u=e.enableProfile,u=void 0===u||u,c=e.enableHttp2,c=void 0!==c&&c,e=_objectWithoutProperties(e,_excluded2);return _global.miniprogramThis.uploadFile(_objectSpread({url:t,filePath:o,name:i,header:r,formData:n,timeout:a,enableProfile:u,enableHttp2:c},e))}function getSystemInfoSync(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["window","device","appBase"];return"function"==typeof _global.miniprogramThis.getWindowInfo?e.reduce(function(e,t){return _objectSpread(_objectSpread({},e),_global.miniprogramThis["get".concat(t.charAt(0).toUpperCase()+t.substring(1),"Info")]())},{}):_global.miniprogramThis.getSystemInfoSync()}function vibrateShort(e){if("devtools"!==getSystemInfoSync(["window","device"]).platform)return _global.miniprogramThis.vibrateShort(e)}function getMenuButtonBoundingClientRectSync(){var t;try{if(null===(t=_global.miniprogramThis.getMenuButtonBoundingClientRect?_global.miniprogramThis.getMenuButtonBoundingClientRect():null))throw"getMenuButtonBoundingClientRect error";if(!(t.width&&t.top&&t.left&&t.height))throw"getMenuButtonBoundingClientRect error"}catch(e){var o=getSystemInfoSync(["window","device"]),i=!!(o.system.toLowerCase().search("ios")+1),r=88,n=4;"android"===o.platform?(n=8,r=96):"devtools"===o.platform&&(n=i?5.5:7.5),o.statusBarHeight||(o.statusBarHeight=o.screenHeight-o.windowHeight-20),t={bottom:o.statusBarHeight+n+32,height:32,left:o.windowWidth-r-10,right:o.windowWidth-10,top:o.statusBarHeight+n,width:r}}return t}function nextTick(e){return"function"==typeof _global.miniprogramThis.nextTick?_global.miniprogramThis.nextTick(e):"undefined"!=typeof Promise?Promise.resolve().then(e):void setTimeout(function(){return e()},0)}